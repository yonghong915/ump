<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace和定义的Mapper接口对应，并实现其中的方法 -->
<mapper namespace="com.ump.sysmgr.user.dao.UserDao">
	<resultMap type="com.ump.sysmgr.user.model.User" id="userResultMap" extends="com.ump.core.base.dao.IBaseDao.baseResultMap">
		<result column="user_code" property="userCode" jdbcType="VARCHAR" />
		<result column="user_name" property="userName" jdbcType="VARCHAR" />
		<result column="user_desc" property="userDesc" jdbcType="VARCHAR" />
		<result column="user_type" property="userType" jdbcType="CHAR" />
		<result column="user_pwd" property="userPwd" jdbcType="VARCHAR" />
		<result column="salt" property="salt" jdbcType="VARCHAR" />
	</resultMap>

	<sql id="sql_select">
		SELECT id,user_code,
		user_name,
		user_desc,
		user_type,
		user_pwd,
		salt,
		create_date

	</sql>
	<sql id="base_column_list">
		user_name
	</sql>

	<select id="findUserByUserCode" resultMap="userResultMap" parameterType="java.lang.String">
		<include refid="sql_select" />
		FROM sys_user_info
		WHERE user_code = #{value}
		AND status = '1'
	</select>

	<insert id="insert">
		INSERT INTO
		sys_user_info(id,user_code,user_name,user_desc,user_type,user_pwd,salt,status,create_date,creator)
		VALUES(#{id},#{userCode},#{userName},#{userDesc},#{userType},#{userPwd},#{salt},'1',NOW(),#{creator})
	</insert>

	<update id="update">
		UPDATE sys_user_info
		<set>
			<if test="userCode != null">
				user_code = #{userCode},
			</if>
			<if test="userName != null and userName != ''">
				user_name = #{userName},
			</if>
			<if test="userDesc != null and userDesc != ''">
				user_desc = #{userDesc},
			</if>
			<if test="userType != null and userType != ''">
				user_type = #{userType},
			</if>
			<if test="userPwd != null and userPwd != ''">
				user_pwd = #{userPwd},
			</if>

			<if test="salt != null and salt != ''">
				salt = #{salt},
			</if>

			<if test="status != null and status != ''">
				status = #{status},
			</if>
			<if test="updator != null and updator != ''">
				updator = #{updator},
			</if>
		</set>
		,update_date = NOW()
		WHERE id = #{id}
	</update>

	<delete id="delete" parameterType="java.lang.String">
		DELETE FROM sys_user_info
		WHERE id = #{id}
	</delete>


	<select id="findByPage" resultMap="userResultMap" parameterType="java.lang.String">
		<include refid="sql_select" />
		FROM sys_user_info
		WHERE status = '1'
		<if test="param.beginTime != null and param.beginTime !=''  ">
       <![CDATA[
        	AND DATE_FORMAT(create_date, '%Y-%m-%d') >=  DATE_FORMAT(#{param.beginTime}, '%Y-%m-%d')
       ]]>
		</if>
		<if test="param.endTime != null and param.endTime !=''  ">
       <![CDATA[
        	AND DATE_FORMAT(create_date, '%Y-%m-%d') <=  DATE_FORMAT(#{param.endTime}, '%Y-%m-%d')
       ]]>
		</if>
		ORDER BY create_date DESC
	</select>
</mapper>