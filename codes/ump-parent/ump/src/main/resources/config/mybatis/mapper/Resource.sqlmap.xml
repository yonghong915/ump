<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace和定义的Mapper接口对应，并实现其中的方法 -->
<mapper namespace="com.ump.cfn.sysmgr.resource.dao.ResourceDao">
	<resultMap type="com.ump.cfn.sysmgr.resource.model.Resource" id="resourceResultMap" extends="com.ump.core.base.dao.BaseDao.baseResultMap">
		<id column="pid" property="resourceId" />
		<result column="resource_name" property="resourceName" jdbcType="VARCHAR" />
		<result column="resource_desc" property="resourceDesc" jdbcType="VARCHAR" />
	</resultMap>

	<select id="findById" resultMap="resourceResultMap" parameterType="java.lang.String">
		SELECT pid,resource_name,resource_desc
		FROM sys_resource
		WHERE pid = #{value}
	</select>

    <select id="findResourcesByUserName" parameterType="string" resultMap="resourceResultMap" >
	    SELECT sre.pid,sre.resource_desc,sre.resource_desc,sre.url
		from sys_user su 
		join sys_user_role sur on su.pid = sur.user_id
		join sys_role sr on sur.role_id = sr.pid
		join sys_role_permission srp on srp.role_id = sr.pid
		join sys_permission sp on srp.permission_id = sp.pid
		join sys_permission_resource spr on spr.permission_id = sp.pid
		join sys_resource sre on spr.resource_id = sre.pid
		where su.user_code=#{value}
	</select>
</mapper>